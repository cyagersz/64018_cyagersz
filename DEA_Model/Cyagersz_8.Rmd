---
title: "Cyagersz_8"
author: "Cole Yagersz"
output: html_document
---

## Introduction
The Hope Valley Health Care Association owns and operates six nursing homes in adjoining
states. An evaluation of their efficiency has been undertaken using two inputs and two outputs.The inputs are staffing labor (measured in average hours per day) and the cost of supplies (in thousands of dollars per day). The outputs are the number of patient-days reimbursed by third-party sources and the number of patient-days reimbursed privately.
Questions:
1. Formulate and perform DEA analysis under all DEA assumptions of FDH, CRS, VRS,
IRS, DRS, and FRH.
2. Determine the Peers and Lambdas under each of the above assumptions
3. Summarize your results in a tabular format
4. Compare and contrast the above results


```{r}
library("lpSolveAPI")   # loads the lp solve library
library("Benchmarking") # loads the library for the DEA Model
```

```{r}

x <- matrix(c(150,400, 320, 520, 350, 320,.2,.7,1.2,2,1.2,.7),ncol=2) # Convert Supplies because it is in thousands per Day
y <- matrix(c(14000, 14000, 42000, 28000, 19000, 14000,3500, 21000, 10500, 42000, 25000, 15000),ncol=2)
colnames(y) <- c("Reimbursed","Privately Paid")
colnames(x) <- c("Staff Hours per Day","Supplies per Day")

cat("Input Data:\n")

print(x)


cat("Output Data:\n")

print(y)
```
Questions 1&2:
```{r}
cat("CRS:\n")
dea_crs <- dea(x,y,RTS ="crs")
print(dea_crs)
print(peers(dea_crs))
print(lambda(dea_crs))

dea.plot(x, y, RTS = "crs", ORIENTATION = "in-out", txt = rownames(x))

```

For CRS (constant return to scale) we found that both DMU 5 and 6 are inefficient.We see that DMU 5 is only 97.75% efficient, and DMU 6 is 86.75% efficient. The peers for both of them are 1,2,and 4.
```{r}
cat("VRS:\n")
dea_vrs <- dea(x,y,RTS ="vrs")
print(dea_vrs)
print(peers(dea_vrs))
print(lambda(dea_vrs))

dea.plot(x, y, RTS = "vrs", ORIENTATION = "in-out", txt = rownames(x))

```

For VRS (varying return to scale) we found that only DMU 6 is inefficient with a 89.63% efficiency.Its peers are 1,2,and 5.

```{r}
cat("IRS:\n")
dea_irs <- dea(x,y,RTS ="irs")
print(dea_irs)
print(peers(dea_irs))
print(lambda(dea_irs))

dea.plot(x, y, RTS = "irs", ORIENTATION = "in-out", txt = rownames(x))
```

For IRS (increasing return to scale) we found that DMU 6 is inefficient with a efficiency of 89.63% the same as VRS.Its peers are 1,2,and 5.
```{r}
cat("DRS:\n")
dea_drs <- dea(x,y,RTS ="drs")
print(dea_drs)
print(peers(dea_drs))
print(lambda(dea_drs))

dea.plot(x, y, RTS = "drs", ORIENTATION = "in-out", txt = rownames(x))
```

For DRS (decreasing return to scale) we found that DMU 5 and DMU 6 are inefficient. DMU 5 has a efficiency of 97.75%. DMU 6 has a efficiency of 86.75%. The peers for both of them are 1,2,and 4.
```{r}
cat("FDH:\n")
dea_fdh <- dea(x,y,RTS ="fdh")
print(dea_fdh)
print(peers(dea_fdh))
print(lambda(dea_fdh))

dea.plot(x, y, RTS = "fdh", ORIENTATION = "in-out", txt = rownames(x))
```

For FDH (Free Disposal Hull) we found that all the DMU are efficient.

```{r}
cat("FRH:\n")
dea_frh <- dea(x,y,RTS = "add") # Uses add because FRH is not supported by Benchmarking Library
print(dea_frh)
print(peers(dea_frh))
print(lambda(dea_frh))

dea.plot(x, y, RTS = "add", ORIENTATION = "in-out", txt = rownames(x))
```

For FRH (Free Disposal Hull with Returns to Scale) we found that all the DMU are efficient just like FDH.


Question 3:
```{r}
DMU_eff <- paste("Facility",1:6)

efficiency_table <- data.frame(
  DMU = DMU_eff,
  CRS = efficiencies(dea_crs),
  VRS = efficiencies(dea_vrs),
  IRS = efficiencies(dea_irs),
  DRS = efficiencies(dea_drs),
  FDH = efficiencies(dea_fdh),
  FRH = efficiencies(dea_frh)
)

print(efficiency_table)

```


Question 4:
Comparison and Contrast of DEA Results:

The CRS and DRS models indicate that Facilities 5 and 6 are inefficient showing scale effects are important in these assumptions. VRS and IRS models, which allow variable and increasing returns to scale respectively only show Facility 6 as inefficient. The FDH and Additive/FRH models find all facilities to be efficient due to their non-convex technology assumptions. This comparison shows how the choice of DEA model influences the interpretation of efficiency, reflecting different operational and scale conditions in the nursing homes










